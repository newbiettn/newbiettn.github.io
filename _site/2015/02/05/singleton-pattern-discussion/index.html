<!DOCTYPE html>
<html>
  <head>
    <meta content='Singleton pattern discussion - newbiettn' property='og:title' />
    <title>Singleton pattern discussion - newbiettn</title>
    	<!--
	#    #  ######  #    #  #####   #  ######  #####  #####  #    #
	##   #  #       #    #  #    #  #  #         #      #    ##   #
	# #  #  #####   #    #  #####   #  #####     #      #    # #  #
	#  # #  #       # ## #  #    #  #  #         #      #    #  # #
	#   ##  #       ##  ##  #    #  #  #         #      #    #   ##
	#    #  ######  #    #  #####   #  ######    #      #    #    #
	-->
	<link rel="canonical" href="http://127.0.0.1:4000/2015/02/05/singleton-pattern-discussion/" />
	<link rel="shortcut icon" href="http://127.0.0.1:4000/images/favicon.jpg" />
	<!-- DATA OF DATA -->
	<meta charset="UTF-8" />
	<meta name="description" content="A great hideout, where I am personally delighted to discuss topics of interest mostly in Computer Science">
	<meta name="author" content="newbiettn">
	<!-- Set the viewport width to device width for mobile -->
	<meta name="viewport" content="width=device-width" />
	<!-- Adore HTTPS -->
	<script type="text/javascript">
	    var host = "ngoctran.me";
	    if ((host == window.location.host) && (window.location.protocol != "https:"))
	        window.location.protocol = "https";
	</script>
	<!-- MAKEUP -->
	<link rel='stylesheet' id='foundation-css' href='http://127.0.0.1:4000/stylesheets/foundation.css?ver=4.5.3' type='text/css' media='all' />
	<link rel='stylesheet' id='aude-layout-css' href='http://127.0.0.1:4000/stylesheets/style.css' type='text/css' media='all' />
	<link rel='stylesheet' id='foundation-css' href='http://127.0.0.1:4000/stylesheets/syntax.css' type='text/css' media='all' />
	<!-- ACTIONS -->
	<script type='text/javascript' src='http://127.0.0.1:4000/javascripts/jquery.js'></script>
	<script src='https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>
	<script type='text/javascript' src='http://127.0.0.1:4000/javascripts/modernizr.foundation.js?ver=4.5.3'></script>
	<script type="text/x-mathjax-config">
	    MathJax.Hub.Config({
				tex2jax: {
					inlineMath: [['$','$']],
					displayMath: [['$$','$$']],
				},
				TeX: {
					equationNumbers: {
						autoNumber: "AMS",
						formatNumber: function (n) {return n},
						extensions: ["AMSmath.js"]
					}
				}
			});
	</script>

  </head>
  <body class="home blog">
  	<div class="preloader">
    		<div class="preload-status">&nbsp;</div>
  	</div>
  	<!-- Header -->
      <header class="row site-header">
     <div class="one columns">
     </div>
     <div class="nine columns ">
        <div class="row border-top-normal">
           <a href="http://127.0.0.1:4000">
              <h1 class="logo">newbiettn</h1>
           </a>
           <p class="motto">Standing on the shoulders of giants</p>
        </div>
     </div>
     <div class="two columns fixed">
        <nav class="border-top-normal">
           <ul id="themenu" class="navigation">
              
              <li>
                 <a target="_top"
                    class="navigation"
                    href="http://127.0.0.1:4000/">
                 Home
                 </a>
              </li>
              
              <li>
                 <a target="_top"
                    class="navigation"
                    href="http://127.0.0.1:4000/maths">
                 Maths
                 </a>
              </li>
              
              <li>
                 <a target="_top"
                    class="navigation"
                    href="http://127.0.0.1:4000/about">
                 About
                 </a>
              </li>
              
           </ul>
        </nav>
     </div>
  </header>

  	<!-- End Header -->
    <!-- Main Page Content and Sidebar -->
    <div class="row site-main">
    	<div class="one columns">
    	</div>
    	<div class="content-container nine columns">
    		<!-- Post -->
        <div class="row article-container">
    			<div class="twelve columns">
    				<div class="row border-top-normal">
    						<article>
    							<div>
    								<header class="post_title">
    									<div class="row">
    										<div class="one columns">
    											<time class="dateline" datetime="February 05, 2015">February 05, 2015</time>
    										</div>
    										<div class="eleven columns">
    											<h2><a href="#" title="Singleton pattern discussion">Singleton pattern discussion</a></h2>
    										</div>
    									</div>
    								</header>
                    <div class="row">
                      <div class="maincontent">
                        <div class="twelve columns">
                          <p>The <strong>Singleton </strong>pattern was used widely across in my projects. Back in time, I was confused when it came to an issue: if I should define <code class="highlighter-rouge">getInstance()</code> method with supplied parameters.</p>

<p>My $0.02 is <strong>definitely not</strong>, since you intend to pass arguments to <code class="highlighter-rouge">getInstance()</code> method, singleton is no longer itself. I think it would be much more like a factory by which you can instantiate many sorts of instances depending on passing arguments.</p>

<p>Let’s get hands dirty by making ourselves a singleton class.</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SingletonDemo</span> <span class="o">{</span>
	<span class="kd">private</span> <span class="kd">static</span> <span class="n">SingletonDemo</span> <span class="n">instance</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

	<span class="kd">private</span> <span class="nf">SingletonDemo</span> <span class="o">()</span> <span class="o">{}</span>

	<span class="kd">public</span> <span class="kd">static</span> <span class="kd">synchronized</span> <span class="n">SingletonDemo</span> <span class="nf">getInstance</span><span class="o">(){</span>
		<span class="k">if</span> <span class="o">(</span><span class="n">instance</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
			<span class="n">instance</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SingletonDemo</span><span class="o">();</span>
		<span class="o">}</span>
		<span class="k">return</span> <span class="n">instance</span><span class="o">;</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<p>Here we have a SingletonDemo class which will return a singleton by invoking the method <code class="highlighter-rouge">getInstance()</code> . The class seems to be fine, however, we can still optimize it by using <strong>Initialization-on-demand holder idiom</strong>.</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SingletonDemo</span> <span class="o">{</span>
	<span class="kd">private</span> <span class="nf">SingletonDemo</span> <span class="o">()</span> <span class="o">{}</span>

	<span class="kd">private</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">SingletonDemoHolder</span> <span class="o">{</span>
		<span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">SingletonDemo</span> <span class="n">INSTANCE</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SingletonDemo</span><span class="o">();</span>
	<span class="o">}</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="kd">synchronized</span> <span class="n">SingletonDemo</span> <span class="nf">getInstance</span><span class="o">(){</span>
		<span class="k">return</span> <span class="n">SingletonDemoHolder</span><span class="o">.</span><span class="na">INSTANCE</span><span class="o">;</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<p>The refactored code is better in the sense that the class <code class="highlighter-rouge">SingletonDemo</code>  has no static variables and the static inner class is not loaded until the JVM executes it. It provides thread safety.</p>

<p>Now suppose the class has properties and of course we need to initialize the instance after instantiating. We have two ways to make it. We either add parameters to <code class="highlighter-rouge">getInstance()</code>  method or define a new <code class="highlighter-rouge">init()</code>  method with mandatory parameters. From my point of view, both the former and the latter have pros and cons:</p>

<ol>
  <li>
    <p>The former perhaps _destroys _the <strong>Singleton </strong>pattern in the sense that the singleton now serves like a factory by which we can instantiate many different instances by supplying different arguments.</p>
  </li>
  <li>
    <p>The latter, which exploits additional initialization method <code class="highlighter-rouge">init()</code> , preserves the <strong>Singleton </strong>pattern, however, it is not consistency since <em>developers may forget to invoke</em> <code class="highlighter-rouge">init()</code> , which results in <strong>incomplete instantiation</strong>. It’s considered as bad coding practice I think.</p>
  </li>
</ol>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SingletonDemo</span> <span class="o">{</span>
	<span class="kd">private</span> <span class="nf">SingletonDemo</span> <span class="o">()</span> <span class="o">{}</span>

	<span class="kd">private</span> <span class="n">Foo</span> <span class="n">foo</span><span class="o">;</span>
	<span class="kd">private</span> <span class="n">Bar</span> <span class="n">bar</span><span class="o">;</span>

	<span class="kd">private</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">SingletonDemoHolder</span> <span class="o">{</span>
		<span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">SingletonDemo</span> <span class="n">INSTANCE</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SingletonDemo</span><span class="o">();</span>
	<span class="o">}</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="kd">synchronized</span> <span class="n">SingletonDemo</span> <span class="nf">getInstance</span><span class="o">(){</span>
		<span class="k">return</span> <span class="n">SingletonDemoHolder</span><span class="o">.</span><span class="na">INSTANCE</span><span class="o">;</span>
	<span class="o">}</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">init</span><span class="o">(</span><span class="n">Foo</span> <span class="n">f</span><span class="o">,</span> <span class="n">Bar</span> <span class="n">b</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">this</span><span class="o">.</span><span class="na">foo</span> <span class="o">=</span> <span class="n">f</span><span class="o">;</span>
		<span class="k">this</span><span class="o">.</span><span class="na">bar</span> <span class="o">=</span> <span class="n">b</span><span class="o">;</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

                        </div>
                      </div>
                    </div>
                    
                  </div>
                </article>
              </div>
    			</div>
    		</div>
        <!-- End Post -->
    </div>
    <aside class="two columns fixed">
      <div class="row sidebar ">
      </div>
    </aside>
  </div>
      <!-- Footer -->
  <footer class="row site-footer">
     <div class="one columns"> </div>
     <div class="nine columns border-top-normal">
        <div class="row">
           <div class="twelve columns ">
              <p class="text-center">No Rights Reserved - Information is FREE</p>
           </div>
        </div>
     </div>
     <div class="two columns"> </div>
  </footer>
  <script type='text/javascript' src='http://127.0.0.1:4000/javascripts/foundation.min.js?ver=4.5.3'></script>
  <script type='text/javascript' src='http://127.0.0.1:4000/javascripts/app.js?1423606192&#038;ver=4.5.3'></script>
  <script type='text/javascript' src='http://127.0.0.1:4000/javascripts/jquery.foundation.buttons.js?ver=4.5.3'></script>
  <script>
     (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
     (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
     m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
     })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

     ga('create', 'UA-89236717-1', 'auto');
     ga('send', 'pageview');

  </script>
  <!-- End Footer -->

  </body>
</html>
